default_language_version:
  python: python3.10.19
repos:
- repo: local
  hooks:
  - id: check-commit-message
    name: check-commit-message
    entry: poetry run python
    language: system
    args:
    - scripts/check_commit_message.py
    stages:
    - commit-msg
    pass_filenames: true
    additional_dependencies: []
  - id: github-actions-flag-status
    name: github-actions-flag-status
    entry: poetry run python
    language: system
    args:
    - scripts/check_actions_flag.py
    pass_filenames: false
    stages:
    - pre-commit
    verbose: true
  - id: black
    name: black (format)
    entry: poetry run black
    language: system
    types:
    - python
    args:
    - --quiet
    stages:
    - pre-commit
    require_serial: true
  - id: ruff
    name: ruff (lint & fix)
    entry: poetry run ruff
    language: system
    types:
    - python
    args:
    - check
    - --fix
    - --quiet
    - .
    pass_filenames: false
    stages:
    - pre-commit
    always_run: true
    require_serial: true
  - id: mypy
    name: mypy (type-check)
    entry: poetry run mypy
    language: system
    types:
    - python
    stages:
    - pre-commit
    pass_filenames: false
  - id: update-modules-lock
    name: update-modules-lock
    entry: poetry run rapidkit modules lock --overwrite
    language: system
    files: ^src/modules/
    pass_filenames: false
- repo: https://github.com/pre-commit/pre-commit-hooks
  rev: v4.6.0
  hooks:
  - id: trailing-whitespace
    name: trailing-whitespace (fix)
    types:
    - text
    args:
    - --markdown-linebreak-ext=md
  - id: end-of-file-fixer
    name: end-of-file-fixer
    types:
    - text
    exclude: module\.verify\.json$
  - id: mixed-line-ending
    name: mixed-line-ending (fix)
    types:
    - text
    args:
    - --fix=lf
  - id: check-yaml
    name: check-yaml
    types:
    - yaml
  - id: check-json
    name: check-json
    types:
    - json
  - id: check-toml
    name: check-toml
    types:
    - toml
  - id: check-merge-conflict
    name: check-merge-conflict
    types:
    - text
  - id: check-added-large-files
    name: check-added-large-files
    args:
    - --maxkb=500
  - id: check-case-conflict
    name: check-case-conflict
  - id: check-shebang-scripts-are-executable
    name: check-shebang-scripts-are-executable
    types:
    - text
    exclude: \.j2$
- repo: https://github.com/psf/black
  rev: 24.8.0
  hooks:
  - id: black
    name: black (double-check)
    stages:
    - pre-commit
    language_version: python3
    args:
    - --check
    - --diff
- repo: https://github.com/charliermarsh/ruff-pre-commit
  rev: v0.6.8
  hooks:
  - id: ruff
    name: ruff (double-check)
    stages:
    - pre-commit
    args:
    - --exit-zero
    - .
    pass_filenames: false
    always_run: true
- repo: https://github.com/executablebooks/mdformat
  rev: 0.7.17
  hooks:
  - id: mdformat
    name: mdformat (markdown formatter)
    additional_dependencies:
    - mdformat-gfm
    - mdformat-black
    args:
    - --wrap=100
- repo: https://github.com/shellcheck-py/shellcheck-py
  rev: v0.10.0.1
  hooks:
  - id: shellcheck
    name: shellcheck (shell script linter)
    args:
    - -e
    - SC1091
    - -e
    - SC2002
